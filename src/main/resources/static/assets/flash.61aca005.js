var Z=Object.defineProperty,j=Object.defineProperties;var G=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var V=(l,o,a)=>o in l?Z(l,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[o]=a,B=(l,o)=>{for(var a in o||(o={}))H.call(o,a)&&V(l,a,o[a]);if(z)for(var a of z(o))J.call(o,a)&&V(l,a,o[a]);return l},w=(l,o)=>j(l,G(o));var E=(l,o,a)=>new Promise((f,_)=>{var s=n=>{try{m(a.next(n))}catch(h){_(h)}},b=n=>{try{m(a.throw(n))}catch(h){_(h)}},m=n=>n.done?f(n.value):Promise.resolve(n.value).then(s,b);m((a=a.apply(l,o)).next())});import{d as W,a as p,r as X,o as D,q as Y,e as c,w as r,f as e,c8 as ee,bo as te,c as $,Z as ae,h as g,i as x}from"./index.9ea39232.js";import{E as oe}from"./el-switch.05966c42.js";import{u as se,B as le}from"./useTable.db1db6c5.js";import{r as ne,B as ie}from"./useForm.c467aa96.js";import{g as A,a as re,b as ue,c as me,u as ce,d as de}from"./promotion.0520d05c.js";import{B as fe}from"./index.4c756888.js";import{u as pe}from"./product.2dbecb13.js";import{b as R}from"./dateUtil.648bdb8e.js";import{_ as ge}from"./timeQuantum.8b202b10.js";/* empty css               */import"./el-popper.9aa5ade8.js";/* empty css                  */import"./el-input-number.e6179de6.js";import"./check.8d7cf096.js";import"./useWindowSizeFn.4d8673c8.js";import"./onMountedOrActivated.21e8b91f.js";import"./el-divider.c329bdb5.js";import"./sortable.esm.6991fe44.js";import"./log.b69fc4f1.js";import"./uniqBy.067f2c9d.js";import"./el-form-item.f36f1992.js";import"./uniq.030252d7.js";/* empty css                 */import"./el-space.f4d2670a.js";import"./useTableFomatter.c95f95bd.js";import"./table.e172cbb0.js";const _e=g("\u79D2\u6740\u65F6\u95F4\u6BB5\u5217\u8868"),he=g("\u65B0\u589E"),ve=g("\u8BBE\u7F6E\u5546\u54C1"),Ce=g("\u7F16\u8F91"),Be=g("\u5220\u9664"),Re=g("\u65B0\u589E"),Je=W({__name:"flash",setup(l){const{getRoleList:o}=pe(),a=p(!1),f=p(!1),_=p(),s=p({}),b=p(!1),m=p(0),n=p([]);n.value=A;const h=X({pageSize:10,pageNum:1});let T=re;function v(u,t){m.value=t,t===1?n.value=[{field:"roleIds",label:"\u4E0A\u7EA7\u5206\u7C7B",component:"ElSelect",itemProps:{multiple:!0},searchList:o.map(i=>({label:i.name,value:i.id}))}]:n.value=A,s.value=u&&u.id?u:{status:1},e(f).visibleRef=!0}function I(u){}const[N,F]=ne();function U(){}let k=ue();k[1].editEvnets={input:U};const[L,{getForm:be,reload:y}]=se({api:T,columns:k,useSearchForm:!0,formConfig:B({},me()),showTableSetting:!0,tableSetting:{fullScreen:!0},showIndexColumn:!1,rowKey:"key",isTreeTable:!0});function P(u){return E(this,null,function*(){return s.value=u,m.value=2,e(s).status=e(s).status===0?1:0,yield S()})}let S=u=>E(this,null,function*(){if(e(m)===1){updateUserRole(B({adminId:e(s).id},F.getFieldsValue())).then(t=>{e(f).visibleRef=!1,y()});return}if(e(s).id){let t=u?w(B({},F.getFieldsValue()),{id:e(s).id}):e(s);t.startDate=R(t.startDate),t.endDate=R(t.endDate),yield ce(t).then(i=>{if(i)return e(f).visibleRef=!1,y(),!0})}else{let t=F.getFieldsValue();t.startDate=R(t.startDate),t.endDate=R(t.endDate),de(t).then(i=>{if(i)return e(f).visibleRef=!1,y(),!0})}return!1});function q(u,t){s.value=u,m.value=2,e(s).status=0,S()}const K=()=>{e(_).toggleCanResize({},null)};let M=[];return(u,t)=>{const i=x,O=x;return D(),Y(ae,null,[c(e(le),{columns:e(k),dataSource:e(M),canResize:a.value,loading:b.value,showTableSetting:"",pagination:h,tableSearchQuery:{pageNum:1,pageSize:50},api:e(T),useSearchForm:"",onColumnsChange:I,onRegister:e(L)},{"form-advanceBefore":r(()=>[c(i,{type:"danger",onClick:t[0]||(t[0]=d=>v(null,3))},{default:r(()=>[_e]),_:1}),c(i,{type:"danger",onClick:v},{default:r(()=>[he]),_:1})]),"col-operate":r(({row:d,column:Q})=>[c(i,{size:"small",type:"primary",onClick:C=>v(d,3)},{default:r(()=>[ve]),_:2},1032,["onClick"]),c(i,{size:"small",type:"primary",onClick:C=>v(d,2)},{default:r(()=>[Ce]),_:2},1032,["onClick"]),c(e(ee),{title:"Are you sure to delete this?",onConfirm:C=>q(d)},{reference:r(()=>[c(i,{size:"small",type:"danger"},{default:r(()=>[Be]),_:1})]),_:2},1032,["onConfirm"])]),"col-status":r(({row:d,column:Q})=>[c(e(oe),{modelValue:d.status,"onUpdate:modelValue":C=>d.status=C,class:"ml-2","active-value":1,"inactive-value":0,"before-change":()=>P(d)},null,8,["modelValue","onUpdate:modelValue","before-change"])]),_:1},8,["columns","dataSource","canResize","loading","pagination","api","onRegister"]),c(e(fe),{ref_key:"modalRef",ref:f,onOk:t[1]||(t[1]=d=>e(S)("edit"))},te({default:r(()=>[m.value===3?(D(),$(ge,{key:0,ref_key:"timeRef",ref:_,promotionRow:s.value},null,8,["promotionRow"])):(D(),$(e(ie),{key:1,onRegister:e(N),model:s.value,schemas:n.value,showActionBtn:!1},null,8,["onRegister","model","schemas"]))]),_:2},[m.value===3?{name:"insertFooter",fn:r(()=>[c(O,{type:"success",onClick:K},{default:r(()=>[Re]),_:1})])}:void 0]),1536)],64)}}});export{Je as default};
