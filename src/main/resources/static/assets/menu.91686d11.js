var Y=Object.defineProperty,ee=Object.defineProperties;var te=Object.getOwnPropertyDescriptors;var L=Object.getOwnPropertySymbols;var ae=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable;var N=(d,i,n)=>i in d?Y(d,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):d[i]=n,p=(d,i)=>{for(var n in i||(i={}))ae.call(i,n)&&N(d,n,i[n]);if(L)for(var n of L(i))oe.call(i,n)&&N(d,n,i[n]);return d},R=(d,i)=>ee(d,te(i));var S=(d,i,n)=>new Promise((A,_)=>{var k=u=>{try{f(n.next(u))}catch(c){_(c)}},g=u=>{try{f(n.throw(u))}catch(c){_(c)}},f=u=>u.done?A(u.value):Promise.resolve(u.value).then(k,g);f((n=n.apply(d,i)).next())});import{d as ne,a as m,r as le,o as I,q as ie,e as r,w as l,f as e,c8 as P,c as U,s as re,Z as se,h,hb as O,hc as ue,hd as de,i as ce}from"./index.9ea39232.js";import{E as me}from"./el-switch.05966c42.js";import{u as fe,B as j}from"./useTable.db1db6c5.js";import{r as pe,B as D}from"./useForm.c467aa96.js";import{B as q}from"./index.4c756888.js";import{c as he,d as ge,e as ve}from"./userData.47e7f627.js";/* empty css               */import"./el-popper.9aa5ade8.js";/* empty css                  */import"./el-input-number.e6179de6.js";import"./check.8d7cf096.js";import"./dateUtil.648bdb8e.js";import"./useWindowSizeFn.4d8673c8.js";import"./onMountedOrActivated.21e8b91f.js";import"./el-divider.c329bdb5.js";import"./sortable.esm.6991fe44.js";import"./log.b69fc4f1.js";import"./uniqBy.067f2c9d.js";import"./el-form-item.f36f1992.js";import"./uniq.030252d7.js";/* empty css                 */import"./el-space.f4d2670a.js";const _e=h("\u65B0\u589E"),be=h("\u67E5\u770B\u4E0B\u7EA7"),Ce=h("\u7F16\u8F91"),Re=h("\u5220\u9664"),ke=h("\u65B0\u589E"),ye=h("\u7F16\u8F91"),Fe=h("\u5220\u9664"),He=ne({__name:"menu",setup(d){const i=m(!1),n=m(!1),A=m(!0),_=le({pageSize:10,pageNum:1});let k=O,g=m(),f=m(),u=m(1);const c=m({}),y=m({});function B(t,a){t&&t.id?c.value=t:(c.value.hidden=0,c.value.parentId=0),a?e(f).visibleRef=!0:(u.value=1,e(g).visibleRef=!0)}let K=t=>{let a=t;return a.parentId=0,a.hidden=0,a},E=m([]);const Q=t=>{E.value=he([{value:0,label:" \u65E0\u4E0A\u7EA7\u5206\u7C7B"},...t.map(a=>({value:a.id,label:a.title}))])};let z=ge();const[V,Z]=pe(),[G,{getForm:Se,reload:T}]=fe({api:k,columns:z,useSearchForm:!0,formConfig:p({},ve()),showTableSetting:!0,tableSetting:{fullScreen:!0},showIndexColumn:!1,rowKey:"key",isTreeTable:!0});function F(t,a){return S(this,null,function*(){if(yield ue(p({},t)).then(s=>{if(u.value===2?w(t):T(),a&&(a.visibleRef=!1),a)return!0}),a)return!1})}let H=[],M=t=>S(this,null,function*(){let a=Z.getFieldsValue();const s=t===1?e(c):e(y);let b=t===1?e(g):e(f);a.productAttributeIdList=a.productAttributeIdList&&[a.productAttributeIdList[1]],s.id?yield F(R(p({},a),{id:s.id}),b):de(a).then(o=>{o.code===200&&(b.visibleRef=!1,T())})}),$=m([]),w=(t,a)=>{e(y).parentId=t.parentId===0?t.id:t.parentId,O({page:1,pageSize:10,parentId:t.parentId===0?t.id:t.parentId,hidden:0}).then(s=>{s&&(u.value=2,$.value=s.data.list,e(g).visibleRef=!0)})};function x(t){return S(this,null,function*(){return yield F(R(p({},t),{hidden:1}),null)})}const J=t=>{e(f).visibleRef=!0},W=t=>{c.value=t},X=t=>{y.value=t};return(t,a)=>{const s=ce,b=me;return I(),ie(se,null,[r(e(j),{columns:e(z),dataSource:e(H),canResize:i.value,loading:n.value,bordered:A.value,showTableSetting:"",pagination:_,tableSearchQuery:{pageNum:1,pageSize:50},api:e(k),useSearchForm:"",afterFetch:Q,onRegister:e(G),onRowClick:W,beforeFetch:e(K)},{"form-advanceAfter":l(()=>[r(s,{type:"danger",onClick:B},{default:l(()=>[_e]),_:1})]),"col-hidden":l(({row:o,column:C})=>[r(b,{modelValue:o.hidden,"onUpdate:modelValue":v=>o.hidden=v,class:"ml-2","active-value":0,"inactive-value":1,"before-change":()=>x(o)},null,8,["modelValue","onUpdate:modelValue","before-change"])]),"col-set":l(({row:o,column:C})=>[r(s,{size:"small",onClick:v=>e(w)(o,0)},{default:l(()=>[be]),_:2},1032,["onClick"])]),"col-oprate":l(({row:o,column:C})=>[r(s,{size:"small",type:"primary",onClick:v=>B(o)},{default:l(()=>[Ce]),_:2},1032,["onClick"]),r(e(P),{title:"Are you sure to delete this?",onConfirm:v=>F(R(p({},o),{hidden:1}),null)},{reference:l(()=>[r(s,{size:"small",type:"danger"},{default:l(()=>[Re]),_:1})]),_:2},1032,["onConfirm"])]),_:1},8,["columns","dataSource","canResize","loading","bordered","pagination","api","onRegister","beforeFetch"]),r(e(q),{ref_key:"modalRef",ref:g,onOk:a[0]||(a[0]=o=>e(M)(1)),height:500},{default:l(()=>[e(u)===1?(I(),U(e(D),{key:0,onRegister:e(V),model:c.value,schemas:e(E),showActionBtn:!1},null,8,["onRegister","model","schemas"])):e(u)===2?(I(),U(e(j),{key:1,columns:e(z),dataSource:e($),canResize:i.value,loading:n.value,showTableSetting:"",pagination:_,useSearchForm:"",height:"300",onRowClick:X},{"col-hidden":l(({row:o})=>[r(b,{modelValue:o.hidden,"onUpdate:modelValue":C=>o.hidden=C,class:"ml-2","active-value":0,"inactive-value":1,"before-change":()=>x(o)},null,8,["modelValue","onUpdate:modelValue","before-change"])]),"form-advanceAfter":l(()=>[r(s,{type:"danger",onClick:J},{default:l(()=>[ke]),_:1})]),"col-oprate":l(({row:o,column:C})=>[r(s,{size:"small",type:"primary",onClick:v=>B(o,!0)},{default:l(()=>[ye]),_:2},1032,["onClick"]),r(e(P),{title:"Are you sure to delete this?",onConfirm:v=>F(R(p({},o),{hidden:1}),null)},{reference:l(()=>[r(s,{size:"small",type:"danger"},{default:l(()=>[Fe]),_:1})]),_:2},1032,["onConfirm"])]),_:1},8,["columns","dataSource","canResize","loading","pagination"])):re("",!0)]),_:1},512),r(e(q),{ref_key:"attrModalRef",ref:f,onOk:a[1]||(a[1]=o=>e(M)(2)),height:500},{default:l(()=>[r(e(D),{onRegister:e(V),model:y.value,schemas:e(E),showActionBtn:!1},null,8,["onRegister","model","schemas"])]),_:1},512)],64)}}});export{He as default};
