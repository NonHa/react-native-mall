var Y=Object.defineProperty,ee=Object.defineProperties;var te=Object.getOwnPropertyDescriptors;var L=Object.getOwnPropertySymbols;var oe=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var $=(u,i,r)=>i in u?Y(u,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):u[i]=r,v=(u,i)=>{for(var r in i||(i={}))oe.call(i,r)&&$(u,r,i[r]);if(L)for(var r of L(i))ae.call(i,r)&&$(u,r,i[r]);return u},M=(u,i)=>ee(u,te(i));var x=(u,i,r)=>new Promise((R,C)=>{var b=s=>{try{f(r.next(s))}catch(c){C(c)}},g=s=>{try{f(r.throw(s))}catch(c){C(c)}},f=s=>s.done?R(s.value):Promise.resolve(s.value).then(b,g);f((r=r.apply(u,i)).next())});import{d as re,a as m,r as ie,p as le,f as e,o as S,q as se,e as n,w as l,c8 as N,c as P,s as ne,Z as ue,h,i as de}from"./index.9ea39232.js";import{u as ce,B as D}from"./useTable.db1db6c5.js";import{r as me,B as V}from"./useForm.c467aa96.js";import{B as j}from"./index.4c756888.js";import{b as pe,c as fe,p as ge}from"./tableData.a4ed2d38.js";import{e as H,f as he,h as _e,i as Ce,u as be}from"./table.e172cbb0.js";/* empty css               */import"./el-popper.9aa5ade8.js";/* empty css                  */import"./el-input-number.e6179de6.js";import"./el-switch.05966c42.js";import"./check.8d7cf096.js";import"./dateUtil.648bdb8e.js";import"./useWindowSizeFn.4d8673c8.js";import"./onMountedOrActivated.21e8b91f.js";import"./el-divider.c329bdb5.js";import"./sortable.esm.6991fe44.js";import"./log.b69fc4f1.js";import"./uniqBy.067f2c9d.js";import"./el-form-item.f36f1992.js";import"./uniq.030252d7.js";/* empty css                 */import"./el-space.f4d2670a.js";const ve=h("\u65B0\u589E"),Re=h("\u67E5\u770B\u4E0B\u7EA7"),Ae=h("\u7F16\u8F91"),Fe=h("\u5220\u9664"),ye=h("\u65B0\u589E"),ke=h("\u7F16\u8F91"),Be=h("\u5220\u9664"),Xe=re({__name:"productCate",setup(u){const i=m(!1),r=m(!1),R=m(!0),C=ie({pageSize:10,pageNum:1});let b=H,g=m(),f=m(),s=m(1);const c=m({}),_=m({});function A(o,t){t?e(f).visibleRef=!0:(c.value=o,s.value=1,e(g).visibleRef=!0)}let O=o=>{let t=o;return t.parentId=0,t},F=pe();const[E,q]=me(),[K,{getForm:Se,reload:Q}]=ce({api:b,columns:F,useSearchForm:!0,formConfig:v({},fe()),showTableSetting:!0,tableSetting:{fullScreen:!0},showIndexColumn:!1,rowKey:"key",isTreeTable:!0}),Z=le(()=>e(s)===2&&e(g).visibleRef),y=()=>{Z.value?I(e(c)):Q()};function z(o){he(o.id).then(t=>{y()})}let G=[],k=m([]);const J=o=>x(this,null,function*(){yield _e().then(t=>{let{data:d}=t;k.value=ge([{field:0,title:" \u65E0\u4E0A\u7EA7\u5206\u7C7B"},...o.map(a=>({field:a.id,title:a.name}))],d.list.map(a=>({field:a.id,title:a.name,children:a.productAttributeList.map(p=>({field:p.id,title:p.name}))})))})});let w=o=>{let t=q.getFieldsValue();const d=o===1?e(c):e(_);let a=o===1?e(g):e(f);t.productAttributeIdList=t.productAttributeIdList&&[t.productAttributeIdList[1]],d.id?be(M(v({},t),{id:d.id})).then(p=>{p&&(a.visibleRef=!1,y())}):Ce(v({},t)).then(p=>{p&&(a.visibleRef=!1,y())})},T=m([]),I=o=>{c.value=o,e(_).parentId=o.id,H({page:1,pageSize:10,parentId:o.id}).then(t=>{t&&(s.value=2,T.value=t.data.list,e(g).visibleRef=!0)})};const U=o=>{_.value={parentId:e(c).id},e(f).visibleRef=!0},W=o=>{c.value=o},X=o=>{_.value=o};return(o,t)=>{const d=de;return S(),se(ue,null,[n(e(D),{title:"\u57FA\u7840\u793A\u4F8B",titleHelpMessage:"\u6E29\u99A8\u63D0\u9192",columns:e(F),dataSource:e(G),canResize:i.value,loading:r.value,bordered:R.value,showTableSetting:"",pagination:C,tableSearchQuery:{pageNum:1,pageSize:50},api:e(b),useSearchForm:"",onRegister:e(K),onRowClick:W,beforeFetch:e(O),afterFetch:J},{"form-advanceAfter":l(()=>[n(d,{type:"danger",onClick:A},{default:l(()=>[ve]),_:1})]),"col-set":l(({row:a})=>[n(d,{size:"small",onClick:p=>e(I)(a)},{default:l(()=>[Re]),_:2},1032,["onClick"])]),"col-oprate":l(({row:a,column:p})=>[n(d,{size:"small",type:"primary",onClick:B=>A(a)},{default:l(()=>[Ae]),_:2},1032,["onClick"]),n(e(N),{title:"Are you sure to delete this?",onConfirm:B=>z(a)},{reference:l(()=>[n(d,{size:"small",type:"danger"},{default:l(()=>[Fe]),_:1})]),_:2},1032,["onConfirm"])]),_:1},8,["columns","dataSource","canResize","loading","bordered","pagination","api","onRegister","beforeFetch"]),n(e(j),{ref_key:"modalRef",ref:g,onOk:t[0]||(t[0]=a=>e(w)(1)),height:500},{default:l(()=>[e(s)===1?(S(),P(e(V),{key:0,onRegister:e(E),model:c.value,schemas:e(k),showActionBtn:!1},null,8,["onRegister","model","schemas"])):e(s)===2?(S(),P(e(D),{key:1,title:"\u57FA\u7840\u793A\u4F8B",titleHelpMessage:"\u6E29\u99A8\u63D0\u9192",columns:e(F),dataSource:e(T),canResize:i.value,loading:r.value,showTableSetting:"",useSearchForm:"",height:"300",onRowClick:X},{"form-advanceAfter":l(()=>[n(d,{type:"danger",onClick:U},{default:l(()=>[ye]),_:1})]),"col-oprate":l(({row:a,column:p})=>[n(d,{size:"small",type:"primary",onClick:B=>A(a,!0)},{default:l(()=>[ke]),_:2},1032,["onClick"]),n(e(N),{title:"Are you sure to delete this?",onConfirm:B=>z(a)},{reference:l(()=>[n(d,{size:"small",type:"danger"},{default:l(()=>[Be]),_:1})]),_:2},1032,["onConfirm"])]),_:1},8,["columns","dataSource","canResize","loading"])):ne("",!0)]),_:1},512),n(e(j),{ref_key:"attrModalRef",ref:f,onOk:t[1]||(t[1]=a=>e(w)(2)),height:500},{default:l(()=>[n(e(V),{onRegister:e(E),model:_.value,schemas:e(k),showActionBtn:!1},null,8,["onRegister","model","schemas"])]),_:1},512)],64)}}});export{Xe as default};
