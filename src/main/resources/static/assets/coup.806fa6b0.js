var L=Object.defineProperty,M=Object.defineProperties;var O=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var z=(a,o,e)=>o in a?L(a,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[o]=e,y=(a,o)=>{for(var e in o||(o={}))P.call(o,e)&&z(a,e,o[e]);if(b)for(var e of b(o))Q.call(o,e)&&z(a,e,o[e]);return a},w=(a,o)=>M(a,O(o));var E=(a,o,e)=>new Promise((C,n)=>{var h=l=>{try{p(e.next(l))}catch(f){n(f)}},d=l=>{try{p(e.throw(l))}catch(f){n(f)}},p=l=>l.done?C(l.value):Promise.resolve(l.value).then(h,d);p((e=e.apply(a,o)).next())});import{d as Z,a as c,r as j,o as k,q as G,e as u,w as r,f as t,c8 as H,bo as J,c as T,Z as U,h as _,i as x}from"./index.9ea39232.js";import{u as W,B as X}from"./useTable.db1db6c5.js";import{r as Y,B as ee}from"./useForm.c467aa96.js";import{s as te,t as oe,v as ae,c as ie,w as ne,x as se,y as re}from"./promotion.0520d05c.js";import{B as le}from"./index.4c756888.js";import{_ as me}from"./timeQuantum.8b202b10.js";/* empty css               */import"./el-popper.9aa5ade8.js";/* empty css                  */import"./el-input-number.e6179de6.js";import"./el-switch.05966c42.js";import"./check.8d7cf096.js";import"./dateUtil.648bdb8e.js";import"./useWindowSizeFn.4d8673c8.js";import"./onMountedOrActivated.21e8b91f.js";import"./el-divider.c329bdb5.js";import"./sortable.esm.6991fe44.js";import"./log.b69fc4f1.js";import"./uniqBy.067f2c9d.js";import"./el-form-item.f36f1992.js";import"./uniq.030252d7.js";/* empty css                 */import"./el-space.f4d2670a.js";import"./useTableFomatter.c95f95bd.js";import"./product.2dbecb13.js";import"./table.e172cbb0.js";const ue=_("\u65B0\u589E"),ce=_("\u67E5\u770B"),pe=_("\u7F16\u8F91"),fe=_("\u5220\u9664"),de=_("\u65B0\u589E"),Qe=Z({__name:"coup",setup(a){const o=c(!1),e=c(!1),C=c(),n=c({}),h=c(!1),d=c(0),p=c([]);p.value=te;const l=j({pageSize:10,pageNum:1});let f=oe;function v(m,i){d.value=i,n.value=m&&m.id?m:{},console.log("editRow",n),t(e).visibleRef=!0}function $(m){}const[N,B]=Y();let F=ae();const[V,{getForm:ge,reload:R}]=W({api:f,columns:F,useSearchForm:!0,formConfig:y({},ie()),showTableSetting:!0,tableSetting:{fullScreen:!0},showIndexColumn:!1,rowKey:"key",isTreeTable:!0});let A=m=>E(this,null,function*(){if(t(n).id){let i=m?w(y({},B.getFieldsValue()),{id:t(n).id}):t(n);yield ne(i).then(s=>{if(s)return t(e).visibleRef=!1,R(),!0})}else{let i=B.getFieldsValue();se(i).then(s=>{if(s)return t(e).visibleRef=!1,R(),!0})}return!1});function q(m,i){re({id:m.id}).then(s=>{s.code===200&&R()})}const D=()=>{t(C).toggleCanResize({},null)};let I=[];return(m,i)=>{const s=x,K=x;return k(),G(U,null,[u(t(X),{columns:t(F),dataSource:t(I),canResize:o.value,loading:h.value,showTableSetting:"",pagination:l,tableSearchQuery:{pageNum:1,pageSize:50},api:t(f),useSearchForm:"",onColumnsChange:$,onRegister:t(V)},{"form-advanceBefore":r(()=>[u(s,{type:"danger",onClick:i[0]||(i[0]=g=>v({}))},{default:r(()=>[ue]),_:1})]),"col-operate":r(({row:g,column:_e})=>[u(s,{size:"small",type:"primary",onClick:S=>v(g,3)},{default:r(()=>[ce]),_:2},1032,["onClick"]),u(s,{size:"small",type:"primary",onClick:S=>v(g,2)},{default:r(()=>[pe]),_:2},1032,["onClick"]),u(t(H),{title:"Are you sure to delete this?",onConfirm:S=>q(g)},{reference:r(()=>[u(s,{size:"small",type:"danger"},{default:r(()=>[fe]),_:1})]),_:2},1032,["onConfirm"])]),_:1},8,["columns","dataSource","canResize","loading","pagination","api","onRegister"]),u(t(le),{ref_key:"modalRef",ref:e,onOk:i[1]||(i[1]=g=>t(A)("edit")),height:500},J({default:r(()=>[d.value===3?(k(),T(me,{key:0,ref_key:"timeRef",ref:C,promotionRow:n.value},null,8,["promotionRow"])):(k(),T(t(ee),{key:1,onRegister:t(N),model:n.value,schemas:p.value,showActionBtn:!1},null,8,["onRegister","model","schemas"]))]),_:2},[d.value===3?{name:"insertFooter",fn:r(()=>[u(K,{type:"success",onClick:D},{default:r(()=>[de]),_:1})])}:void 0]),1536)],64)}}});export{Qe as default};
